/*!
 * Winbows Command Prompt
 * Copyright (c) Microhard 2025
 * Github : Siyu1017/winbows11
 */
var e,t={exports:{}};var r,n,o=e?t.exports:(e=1,self,t.exports=(r=n={},Object.defineProperty(r,"__esModule",{value:!0}),r.FitAddon=void 0,r.FitAddon=class{activate(e){this._terminal=e}dispose(){}fit(){const e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;const t=this._terminal._core;this._terminal.rows===e.rows&&this._terminal.cols===e.cols||(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal)return;if(!this._terminal.element||!this._terminal.element.parentElement)return;const e=this._terminal._core,t=e._renderService.dimensions;if(0===t.css.cell.width||0===t.css.cell.height)return;const r=0===this._terminal.options.scrollback?0:e.viewport.scrollBarWidth,n=window.getComputedStyle(this._terminal.element.parentElement),o=parseInt(n.getPropertyValue("height")),i=Math.max(0,parseInt(n.getPropertyValue("width"))),s=window.getComputedStyle(this._terminal.element),l=o-(parseInt(s.getPropertyValue("padding-top"))+parseInt(s.getPropertyValue("padding-bottom"))),a=i-(parseInt(s.getPropertyValue("padding-right"))+parseInt(s.getPropertyValue("padding-left")))-r;return{cols:Math.max(2,Math.floor(a/t.css.cell.width)),rows:Math.max(1,Math.floor(l/t.css.cell.height))}}},n));!function(e,t){void 0===t&&(t={});var r=t.insertAt;if("undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===r&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".xterm{cursor:text;position:relative;user-select:none;-ms-user-select:none;-webkit-user-select:none}.xterm.focus,.xterm:focus{outline:none}.xterm .xterm-helpers{position:absolute;top:0;z-index:5}.xterm .xterm-helper-textarea{border:0;height:0;left:-9999em;margin:0;opacity:0;overflow:hidden;padding:0;position:absolute;resize:none;top:0;white-space:nowrap;width:0;z-index:-5}.xterm .composition-view{background:#000;color:#fff;display:none;position:absolute;white-space:nowrap;z-index:1}.xterm .composition-view.active{display:block}.xterm .xterm-viewport{background-color:#000;bottom:0;cursor:default;left:0;overflow-y:scroll;position:absolute;right:0;top:0}.xterm .xterm-screen{position:relative}.xterm .xterm-screen canvas{left:0;position:absolute;top:0}.xterm .xterm-scroll-area{visibility:hidden}.xterm-char-measure-element{display:inline-block;left:-9999em;line-height:normal;position:absolute;top:0;visibility:hidden}.xterm.enable-mouse-events{cursor:default}.xterm .xterm-cursor-pointer,.xterm.xterm-cursor-pointer{cursor:pointer}.xterm.column-select.focus{cursor:crosshair}.xterm .xterm-accessibility,.xterm .xterm-message{bottom:0;color:transparent;left:0;pointer-events:none;position:absolute;right:0;top:0;z-index:10}.xterm .live-region{height:1px;left:-9999px;overflow:hidden;position:absolute;width:1px}.xterm-dim{opacity:1!important}.xterm-underline-1{text-decoration:underline}.xterm-underline-2{text-decoration:double underline}.xterm-underline-3{text-decoration:wavy underline}.xterm-underline-4{text-decoration:dotted underline}.xterm-underline-5{text-decoration:dashed underline}.xterm-overline{text-decoration:overline}.xterm-overline.xterm-underline-1{text-decoration:overline underline}.xterm-overline.xterm-underline-2{text-decoration:overline double underline}.xterm-overline.xterm-underline-3{text-decoration:overline wavy underline}.xterm-overline.xterm-underline-4{text-decoration:overline dotted underline}.xterm-overline.xterm-underline-5{text-decoration:overline dashed underline}.xterm-strikethrough{text-decoration:line-through}.xterm-screen .xterm-decoration-container .xterm-decoration{position:absolute;z-index:6}.xterm-screen .xterm-decoration-container .xterm-decoration.xterm-decoration-top-layer{z-index:7}.xterm-decoration-overview-ruler{pointer-events:none;position:absolute;right:0;top:0;z-index:8}.xterm-decoration-top{position:relative;z-index:2}");const i=document.createElement("style");i.innerHTML=".window-content * {color: #fff;font: 1rem monospace;white-space:pre-wrap;line-height: 1.12;} .window-content,.window-toolbar{background:rgb(18, 18, 18) !important;} *::selection{ background:#fff;color:#000} .xterm { height: inherit;}",document.head.appendChild(i),browserWindow.setTheme("dark"),document.documentElement.classList.add("winui"),document.documentElement.classList.add("winui-no-background"),document.documentElement.classList.add("winui-dark"),document.body.style="padding: .5rem; padding-right: 0;";const s=document.createElement("div");function l(e){const t=parseInt(e.replace("#",""),16);return[t>>16&255,t>>8&255,255&t]}function a(e,t,r){const[n,o,i]=l(r);e.write(`[38;2;${n};${o};${i}m${t}[0m`)}function c(e,t){if(t){const[r,n,o]=l(t);e.write(`[38;2;${r};${n};${o}m`)}else e.write("[0m")}s.style="height: 100%;",document.body.appendChild(s),process.title="Command Prompt";const d=new ShellInstance(process,{isTTY:!0}),m=new WinUI.Terminal({cols:80,rows:24,convertEol:!0,cursorBlink:!0,theme:{background:"rgb(18, 18, 18)",foreground:"#d4d4d4"}}),p=new o.FitAddon;await d.execCommand("cd C:/"),m.loadAddon(p),m.open(s);let u=null,h=!0,w="",x=0,f=m.cols,v=[],g=0,y={},b="",C="",$="";function _(e,t,r,n){const o=t.length;r+=o,n+=o;const i=e.cols,s=~~(r/i),l=~~(n/i),a=r%i,c=n%i;if(s!=l&&r!=n){let t=s-l;0==c&&t--,t>0&&e.write(`[${t}A`)}if(a!=c){const t=a-c;t>0?e.write(`[${t}D`):e.write(`[${-t}C`)}}function k(e,t,r){const n=r.slice(e),o=r.match(/\S+/);if(o){const t=o.index+o[0].length;t>e?(c(m,"#ffc96d"),m.write(n.slice(0,t-e)),c(m),m.write(n.slice(t-e))):m.write(n)}else m.write(n);_(m,w,r.length,t)}m.onResize((({cols:e,rows:t})=>{if("normal"!=u)return;const r=w.length,n=~~((x+r)/f);n>0&&m.write(`[${n}A`),m.write("\r[0J"),m.write(w),k(0,x,b),f=m.cols})),m.attachCustomKeyEventHandler((e=>!e.ctrlKey||!["c","v","a"].includes(e.key.toLowerCase()))),m.onKey((async({domEvent:e})=>{const t=e;if(t.ctrlKey&&"a"===t.key.toLowerCase())return m.selectAll(),void t.preventDefault();if(t.ctrlKey&&"c"===t.key.toLowerCase()){t.preventDefault();const e=m.getSelection();e&&await navigator.clipboard.writeText(e)}else;})),d.on("dispose",(e=>{browserWindow.close()})),p.fit();new ResizeObserver((()=>{p.fit()})).observe(s),m.onData((async e=>{if("cli"!==u)return"normal"===u?await async function(e){if(0!=e.length){switch(e){case"[A":if(g>0){const e=x;g--,b=v[g],x=b.length,w=`${path.normalize(d.root+d.pwd)}>`,_(m,w,e,0),m.write("[0J"),k(0,x,b)}return;case"[B":if(g<v.length){const e=x;g++,b=v[g]||"",x=b.length,w=`${path.normalize(d.root+d.pwd)}>`,_(m,w,e,0),m.write("[0J"),k(0,x,b)}return;case"[C":return void(x<b.length&&(x++,x%m.cols==0?m.write("[B\r"):m.write(e)));case"[D":return void(x>0&&(x--,(x+1)%m.cols==0?m.write(`[A\r[${m.cols+1}C`):m.write(e)))}if("\r"===e){if(""!=b.trim()){m.write("\n"),v[v.length-1]!=b&&(v.push(b),g=v.length),u=null;try{const e=await d.execCommand(b);if("cli"===e.type)return u="cli",$="",x=0,y=e,e.stdout.on("data",(e=>{m.write(e)})),e.stderr.on("data",(e=>{a(m,e,"#ff796d")})),void e.process.on("exit",(()=>{m.write("\r\r\n"),h=!0,w=`${path.normalize(d.root+d.pwd)}>`,m.write(w),x=0,b="",u="normal"}))}catch(e){console.error(e)}}1==h&&m.write("\r\n"),h=!0,w=`${path.normalize(d.root+d.pwd)}>`,m.write(w),x=0,b="",u="normal"}else{if(""!==e){const t=x;return b=b.slice(0,x)+e+b.slice(x),x+=e.length,m.write("[0J"),void k(t,x,b)}if(b.length>0&&x>0){const e=x;b=b.slice(0,x-1<0?0:x-1)+b.slice(x),x--;const t=m.cols,r=e+w.length;return r%t==0&&~~(r/t)>0?m.write(`[A[${t}C`):m.write("[D"),m.write("[0J"),void k(x,x,b)}}}}(e):"prompt"===u?function(e){if("prompt"==u&&!/^\x1B\[.*[A-D]$/.test(e))return"\r"===e?(m.write("\r\n"),u=null,d.stdin.write(C),void(C="")):void(""===e?C.length>0&&(C=C.slice(0,-1),m.write("\b \b")):(C+=e,m.write(e)))}(e):void 0;if(!y.stdin?.isPaused?.()){if(y.stdin.isRaw)return y.stdin.write(e);if("\r"==e)$+=e,y.stdin.write($),$="";else if(""===e)$.length>0&&($=$.slice(0,-1),m.write("\b \b"));else{const t=x;$=$.slice(0,x)+e+$.slice(x),x+=e.length,m.write("[0J"),k(t,x,$)}}})),d.stdout.on("data",(e=>{m.write(e)})),d.stderr.on("data",(e=>{a(m,e,"#ff796d")})),d.on("input",(e=>{C="",u="prompt",e.type})),d.stdout.on("clear",(()=>{m.clear(),h=!1})),m.write(`Winbows11 [Version ${System.information.version}]\n(c) Microhard Corporation. All rights reserved.\n\nType "help" for available commands.\n`),w=`${path.normalize(d.root+d.pwd)}>`,m.write("\r\n"+w),u="normal";
