/*!
 * Winbows11 - 90d20c521067acf9
 * Copyright (c) Microhard 2025
 * Github : Siyu1017/winbows11
 */
!function(){"use strict";function e(e){e||(e=location.search);var t=e.substr(1),n={};return t.split("&").forEach((function(e){var t=e.split("=");n[t[0]]=decodeURIComponent(t[1])})),n}if("serviceWorker"in navigator){var t={};window.HMGR={on:function(e,n){t[e]?t[e].push(n):t[e]=[n]},emit:function(e,n){t[e]&&t[e].forEach((function(e){e(n)}))},off:function(e,n){t[e]&&(t[e]=t[e].filter((function(e){return e!==n})))},enable:function(e){navigator.serviceWorker.controller.postMessage({type:"ENABLE",value:e.toUpperCase()})},disable:function(e){navigator.serviceWorker.controller.postMessage({type:"DISABLE",value:e.toUpperCase()})}},navigator.serviceWorker.register("./hmgr.js",{updateViaCache:"none",scope:"./"}).then((e=>{e.update(),console.log("register success")}),(e=>console.log("register fail:",e))),navigator.serviceWorker.ready.then((e=>{navigator.serviceWorker.controller.postMessage({type:"SETUP",value:{location:{href:location.href,origin:location.origin,pathname:location.pathname,search:location.search,hash:location.hash,protocol:location.protocol,hostname:location.hostname,port:location.port,host:location.host}}})})),navigator.serviceWorker.addEventListener("message",(e=>{const t=e.data;t.type&&window.HMGR.emit(t.type,t.value)}))}function n(){document.querySelector(":root").style.setProperty("--winbows-screen-width",window.innerWidth+"px"),document.querySelector(":root").style.setProperty("--winbows-screen-height",window.innerHeight+"px")}Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},window.addEventListener("resize",n),window.addEventListener("load",n),window.System={},function(){function e(){const e=localStorage.getItem("WINBOWS_ROM_FT");return e?JSON.parse(e):(localStorage.setItem("WINBOWS_ROM_FT","[]"),[])}function t(e){return"WINBOWS_ROM_FT:"+e}window.System.rom={list:e,exists:function(t){return e().some((e=>e.n===t))},write:function(n,o){const i=e(),r=i.findIndex((e=>e.n===n));-1!==r&&i.splice(r,1),i.push({n:n,l:o.length}),localStorage.setItem(t(n),o),localStorage.setItem("WINBOWS_ROM_FT",JSON.stringify(i))},read:function(e){return localStorage.getItem(t(e))||""},rm:function(n){const o=e(),i=o.findIndex((e=>e.n===n));-1!==i&&o.splice(i,1),localStorage.removeItem(t(n)),localStorage.setItem("WINBOWS_ROM_FT",JSON.stringify(o))}}}();const o=e();window.modes={},Object.defineProperty(window.modes,"debug",{value:!!(o.dev||o.develop||o.logs||o.output),writable:!1,configurable:!1}),Object.defineProperty(window.modes,"dev",{value:!!(o.dev||o.develop||o.embed),writable:!1,configurable:!1}),async function(){!0===function(){const e=navigator.userAgent,t="ontouchend"in document;return!!/iPhone/.test(e)||!!/iPad/.test(e)||!(!/Macintosh/.test(e)||!t)||/Macintosh/.test(e)}()&&await async function(){return new Promise((e=>{var t=document.createElement("div"),n=document.createElement("div"),o=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElement("div"),r=document.createElement("div"),a=document.createElement("button");t.style="position:fixed;top:0;left:0;width:100vw;height:var(--winbows-screen-height);display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5);z-index:999999999999",n.style="display: flex;flex-direction: column;align-items: center;justify-content: center;background-color: rgb(255, 255, 255);padding: 2rem;border-radius: 1.5rem;box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 1rem;max-width: min(600px,calc(100vw - 2rem));width: 100%;max-height: min(calc(var(--winbows-screen-height)*80%), calc(var(--winbows-screen-height) - 2rem));overflow: auto;",o.style="width:5rem;height:5rem;",o.setAttribute("viewBox","0 0 24 24"),o.setAttribute("fill","none"),o.setAttribute("stroke","#E69264"),o.setAttribute("stroke-width","2"),o.setAttribute("stroke-linecap","round"),o.setAttribute("stroke-linejoin","round"),o.innerHTML='<path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"></path><path d="M12 9v4"></path><path d="M12 17h.01"></path>',i.style="max-width: 80%;word-break: auto-phrase;font-weight: 600;font-size: 1.25rem;margin-top: 1rem;",i.innerHTML="Warning for iPhone/iPad/Mac users",r.style="font-size: .875rem;color: #454545;margin: .375rem;",r.innerHTML="There are a number of known styling issues with Winbows11 on iPhone/iPad/Mac. Until this issue is resolved, we recommend that you use another device to browse this site.",a.style="color: rgb(255, 255, 255);margin-bottom: 0.5rem;padding: 0.75rem 1.25rem;background: rgb(0, 103, 192);border-radius: 0.5rem;font-size:.925rem;text-decoration: none;cursor: pointer;user-select: none;-webkit-user-drag: none;outline: 0;border: 0;margin-top: 1rem;",a.innerHTML="Continue to visit Winbows11",a.addEventListener("click",(()=>{t.remove(),e()})),t.appendChild(n),n.appendChild(o),n.appendChild(i),n.appendChild(r),n.appendChild(a),document.body.appendChild(t)}))}(),window.needsUpdate=!1;const t=localStorage.getItem("WINBOWS_BUILD_ID"),n=document.createElement("script");let o=null,i=!1;function r(e){if(1==i)return;i=!0;const t=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),r=document.createElement("div"),a=document.createElement("div"),s=document.createElement("button");o.innerHTML="An error occurred while loading Winbows11",r.innerHTML=e.message,s.innerHTML="Close",t.style="position: fixed;top: 0px;left: 0px;width: 100vw;height: var(--winbows-screen-height);display: flex;align-items: center;justify-content: center;background-color: rgba(0, 0, 0, 0.5);z-index: 999999999999;font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, Roboto, Oxygen-Sans, Ubuntu, Cantarell, &quot;Helvetica Neue&quot;, sans-serif;color:#000;",n.style="display: flex;flex-direction: column;align-items: center;justify-content: center;background-color: rgb(255, 255, 255);padding: 2rem 4rem;border-radius: 1.5rem;box-shadow: rgba(0, 0, 0, 0.2) 0px 0px 1rem;max-width: min(600px, -2rem + 100vw);width: 100%;max-height: min(calc(var(--winbows-screen-height) * 80%), calc(var(--winbows-screen-height) - 2rem));overflow: auto;",o.style="font-size: 175%;font-weight: 600;margin: .5rem 0 1.5rem;",a.style="display: flex;gap: .5rem;",s.style="color: rgb(255, 255, 255);margin-bottom: 0.5rem;padding: 0.625rem 1.25rem;background: rgb(0, 103, 192);border-radius: 0.5rem;font-size: 1rem;text-decoration: none;cursor: pointer;user-select: none;-webkit-user-drag: none;outline: 0px;border: 1px solid rgb(0, 103, 192);margin-top: 1.5rem;font-family: inherit;font-weight: 600;min-width: 8rem;",t.appendChild(n),n.appendChild(o),n.appendChild(r),n.appendChild(a),a.appendChild(s),document.body.appendChild(t),s.addEventListener("click",(()=>{t.remove()}))}if(n.onerror=r,navigator.onLine){try{const v=await fetch(`/Winbows/System/kernel/kernel.js?timestamp=${(new Date).getTime()}`),y=await v.text();n.textContent=y,System.rom.write("KERNEL.js",y)}catch(x){if(r(x),System.rom.exists("KERNEL.js")){n.textContent=System.rom.read("KERNEL.js");try{document.head.appendChild(n)}catch(E){r(E)}}else console.error("Failed to read KERNEL.js from ROM.")}if("90d20c521067acf9"==t||e().embed)try{document.head.appendChild(n)}catch(k){r(k)}else{window.needsUpdate=!0,document.body.style.backgroundImage="linear-gradient(transparent, transparent)",document.body.style.transition="background-image .2s ease-in-out";try{const S=await fetch(`/build-fetch.json?timestamp=${(new Date).getTime()}`);o=await S.json()}catch(C){console.log(C)}function M(e,t=2){if(0===e)return"0Bytes";const n=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(n))+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}var a=null!=o?M(o.size,0):"[Failed to get build size]",s=null!=o?Math.ceil(66.68625736236572/((navigator.connection?navigator.connection.downlink:2)/4)/60)+"minute(s)":"[Failed to calculate download time]",c=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),m=document.createElement("div"),u=document.createElement("div"),h=document.createElement("div"),p=document.createElement("div"),g=document.createElement("div"),w=document.createElement("button"),b=document.createElement("button");c.className="confirm",l.className="confirm-window",d.className="confirm-symbol",m.className="confirm-content",u.className="confirm-title",h.className="confirm-description",p.className="confirm-tip",g.className="confirm-buttons",w.className="confirm-button outline",b.className="confirm-button",document.body.appendChild(c),c.appendChild(l),l.appendChild(d),l.appendChild(m),m.appendChild(u),m.appendChild(h),m.appendChild(p),m.appendChild(g),g.appendChild(w),g.appendChild(b),u.innerHTML="Install Winbows11 in your browser?",h.innerHTML=`<div>Installing Winbows11 in the browser can make it run more smoothly than using the internet. Its size is about <span class='confirm-highlighted-text'>${a}</span>, and the installation is expected to take around <span class='confirm-highlighted-text'>${s}</span>.</div><br><div>If you don't want to install it, you can also just use the Internet to experience Winbows11! </div>`,p.innerHTML="<div>If you choose to install, we will save the necessary files for Winbows11 to <a href='https://developer.mozilla.org/zh-TW/docs/Web/API/IndexedDB_API/Using_IndexedDB' in the browser target='_blank' class='confirm-learn-link'>Indexed DB</a>. </div>",w.innerHTML="Refuse",b.innerHTML="Install",d.innerHTML='<div class="confirm-symbol-bg"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="confirm-symbol-arrow"><path d="M15 6v10h4l-7 7-7-7h4V6h6z"/></svg></div>',document.body.style.backgroundPosition="center",document.body.style.backgroundSize="cover",document.body.style.backgroundRepeat="no-repeat",document.body.style.backgroundImage="url(./Winbows/bg/img-low-quality.jpg)";var f=!1;w.addEventListener("click",(()=>{if(1!=f){f=!0,w.classList.add("loading"),w.innerHTML='<svg class="winbows-loading-spinner" width="48" height="48" viewBox="0 0 16 16"><circle cx="8px" cy="8px" r="7px"></circle></svg>',w.disabled=!0;try{document.head.appendChild(n)}catch(e){r(e)}}})),b.addEventListener("click",(()=>{location.href=`./install.html?timestamp=${(new Date).getTime()}`}))}}else if(System.rom.exists("KERNEL.js")){n.textContent=System.rom.read("KERNEL.js");try{document.head.appendChild(n)}catch(I){r(I)}}else console.error("Failed to read KERNEL.js from ROM.")}(),console.log("%cWelcome to Winbows11\n%c%cGithub: Siyu1017/winbows11",'font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;background-image: linear-gradient(to right, rgba(71, 202, 250, 255), rgba(3, 124, 213, 255));-webkit-text-fill-color: #0000;background-clip: text;-webkit-background-clip: text;font-weight: 500;font-size: 4rem;',"",'background:rgb(24,24,24);color:#fff;border-radius:.5rem;padding: .5rem 1rem;font-size: 1rem;display: inline-block;font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;')}();
